<section>
  <div class="container">
    <table class="table mt-5">
      <thead>
        <tr>
          <th scope="col">IMAGE</th>
          <th scope="col">PRODUCT</th>
          <th scope="col">PRICE</th>
          <th scope="col">QUANTITY</th>
		  <th></th>
          <th>TOTAL</th>
        </tr>

      </thead>
      <tbody>
        {{#each cartData.products}}
          <tr>
            <td><img
                style="width: 70px;height:70px"
                src="/product_uploads/{{this.productId.image.[0]}}"
                alt=""
              /></td>
            <td>{{this.productId.name}}</td>
            <td>{{this.productId.price}}</td>
            <td>
				<button class="cart-item-count btn-danger px-2 mr-3" onclick="changeQuantity('{{../cartData._id}}','{{this.productId._id}}',-1)">-</button>
				<span id="{{this.productId._id}}">{{this.quantity}}</span>
									<button class="cart-item-count btn-danger px-2 ml-3" onclick="changeQuantity('{{../cartData._id}}','{{this.productId._id}}',1)">+</button>
			</td>
            <td>
              <a href="" onclick="removeCartProduct('{{../cartData._id}}','{{this.productId._id}}')" class="btn btn-danger">Remove</a>
            </td>
            <td class="column-5">{{this.productId.price}}</td>
          </tr>
        {{/each}}
      </tbody>
    </table>
  </div>
</section>


<script>
	function changeQuantity(cartId, prodId, count){
		console.log(cartId, prodId, count, 'bnrrrrrrrrrrrrrrrrrrrrr')
		let quantity = parseInt(document.getElementById(prodId).innerHTML)
		$.ajax({
			url:'/changeProductQuantity',
			data:{
				cartId:cartId,
				prodId:prodId,
				count:count,
				quantity:quantity
			},
			method:'post',
			success:(response)=>{
				if(response.removeProduct){
					alert('product removed from the cart')
					location.reload()
				}
				else{
					document.getElementById(prodId).innerHTML=quantity+count
				}
			}
		})
	}
</script>
